---
/**
 * CookieConsent component for GDPR-compliant cookie consent management.
 * Uses vanilla-cookieconsent library with Google Consent Mode integration.
 * @see https://cookieconsent.orestbida.com/
 */
---

<script>
  import "vanilla-cookieconsent/dist/cookieconsent.css";
  import * as CookieConsent from "vanilla-cookieconsent";

  // Category constants
  const CAT_NECESSARY = "necessary";
  const CAT_ANALYTICS = "analytics";

  // Available languages with native names
  const LANGUAGES: Record<string, string> = {
    en: "English",
    es: "Español",
    fr: "Français",
    de: "Deutsch",
    it: "Italiano",
    pt: "Português",
    nl: "Nederlands",
    ja: "日本語",
    zh: "中文",
    ko: "한국어",
    ar: "العربية",
    pl: "Polski",
    tr: "Türkçe",
    sv: "Svenska",
    ru: "Русский",
  };

  // Language selector labels (translated)
  const LANGUAGE_LABELS: Record<string, string> = {
    en: "Language",
    es: "Idioma",
    fr: "Langue",
    de: "Sprache",
    it: "Lingua",
    pt: "Idioma",
    nl: "Taal",
    ja: "言語",
    zh: "语言",
    ko: "언어",
    ar: "اللغة",
    pl: "Język",
    tr: "Dil",
    sv: "Språk",
    ru: "Язык",
  };

  /**
   * Creates and injects the language selector into the preferences modal.
   */
  function injectLanguageSelector() {
    const prefsModal = document.querySelector(".pm__body");
    if (!prefsModal || document.getElementById("cc-language-selector")) return;

    const currentLang = CookieConsent.getConfig("language").default;
    const label = LANGUAGE_LABELS[currentLang] || "Language";

    const selectorContainer = document.createElement("div");
    selectorContainer.id = "cc-language-selector";
    selectorContainer.className = "pm__section";
    selectorContainer.innerHTML = `
      <div class="pm__section-title-wrapper">
        <h3 class="pm__section-title">${label}</h3>
      </div>
      <div class="pm__section-desc-wrapper">
        <select id="cc-lang-select" class="cc-lang-select">
          ${Object.entries(LANGUAGES)
            .map(
              ([code, name]) =>
                `<option value="${code}" ${code === currentLang ? "selected" : ""}>${name}</option>`
            )
            .join("")}
        </select>
      </div>
    `;

    // Insert at the top of the modal body
    prefsModal.insertBefore(selectorContainer, prefsModal.firstChild);

    // Add change event listener
    const select = document.getElementById("cc-lang-select") as HTMLSelectElement;
    select?.addEventListener("change", (e) => {
      const newLang = (e.target as HTMLSelectElement).value;
      CookieConsent.setLanguage(newLang);
      // Re-inject selector after language change (modal gets rebuilt)
      setTimeout(injectLanguageSelector, 50);
    });
  }

  // Observe for preferences modal opening
  const modalObserver = new MutationObserver((mutations) => {
    for (const mutation of mutations) {
      if (mutation.type === "childList") {
        const prefsModal = document.querySelector(".pm__body");
        if (prefsModal && !document.getElementById("cc-language-selector")) {
          injectLanguageSelector();
        }
      }
    }
  });

  // Start observing after DOM is ready
  modalObserver.observe(document.body, { childList: true, subtree: true });

  // Google Consent Mode service
  const SERVICE_ANALYTICS_STORAGE = "analytics_storage";

  // Define dataLayer and gtag function
  window.dataLayer = window.dataLayer || [];
  function gtag(...args: unknown[]) {
    window.dataLayer.push(args);
  }

  // Set default consent to 'denied' before any other dataLayer operations
  gtag("consent", "default", {
    ad_storage: "denied",
    ad_user_data: "denied",
    ad_personalization: "denied",
    analytics_storage: "denied",
    functionality_storage: "denied",
    personalization_storage: "denied",
    security_storage: "granted",
  });

  /**
   * Updates Google Tag consent based on CookieConsent user choices.
   */
  function updateGtagConsent() {
    const analyticsGranted = CookieConsent.acceptedCategory(CAT_ANALYTICS);

    gtag("consent", "update", {
      analytics_storage: analyticsGranted ? "granted" : "denied",
    });

    // Load Google Analytics if consent is granted
    if (analyticsGranted && !window.gaLoaded) {
      loadGoogleAnalytics();
    }
  }

  /**
   * Dynamically loads the Google Analytics script.
   */
  function loadGoogleAnalytics() {
    const GA_ID = "G-J4M348DW6C";
    const script = document.createElement("script");
    script.async = true;
    script.src = `https://www.googletagmanager.com/gtag/js?id=${GA_ID}`;
    document.head.appendChild(script);

    gtag("js", new Date());
    gtag("config", GA_ID);

    window.gaLoaded = true;
  }

  // Initialize CookieConsent
  CookieConsent.run({
    // Core settings
    cookie: {
      name: "cc_cookie",
      expiresAfterDays: 182,
    },

    // UI settings
    guiOptions: {
      consentModal: {
        layout: "cloud inline",
        position: "bottom center",
        equalWeightButtons: true,
        flipButtons: false,
      },
      preferencesModal: {
        layout: "box",
        equalWeightButtons: true,
        flipButtons: false,
      },
    },

    // Callbacks for consent changes
    onFirstConsent: () => {
      updateGtagConsent();
    },
    onConsent: () => {
      updateGtagConsent();
    },
    onChange: () => {
      updateGtagConsent();
    },

    // Cookie categories
    categories: {
      [CAT_NECESSARY]: {
        enabled: true,
        readOnly: true,
      },
      [CAT_ANALYTICS]: {
        autoClear: {
          cookies: [{ name: /^_ga/ }, { name: "_gid" }],
        },
        services: {
          [SERVICE_ANALYTICS_STORAGE]: {
            label: "Google Analytics",
          },
        },
      },
    },

    // Language and translations
    language: {
      default: "en",
      autoDetect: "browser",
      rtl: ["ar"],
      translations: {
        en: {
          consentModal: {
            title: "We value your privacy",
            description:
              'We use cookies to enhance your browsing experience and analyze site traffic. By clicking "Accept all", you consent to our use of cookies.',
            acceptAllBtn: "Accept all",
            acceptNecessaryBtn: "Reject all",
            showPreferencesBtn: "Manage preferences",
            footer: `
              <a href="/privacy">Privacy Policy</a>
              <a href="/terms">Terms of Service</a>
            `,
          },
          preferencesModal: {
            title: "Cookie Preferences",
            acceptAllBtn: "Accept all",
            acceptNecessaryBtn: "Reject all",
            savePreferencesBtn: "Save preferences",
            closeIconLabel: "Close modal",
            serviceCounterLabel: "Service|Services",
            sections: [
              {
                title: "Your Privacy Choices",
                description:
                  "In this panel you can manage your cookie preferences. You can review and change your choices at any time by reopening this panel via the cookie settings link in the footer.",
              },
              {
                title: "Strictly Necessary",
                description:
                  "These cookies are essential for the website to function properly and cannot be disabled. They are usually set in response to your actions like setting privacy preferences or logging in.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Analytics",
                description:
                  "These cookies help us understand how visitors interact with our website by collecting and reporting information anonymously.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Analytics cookies",
                  headers: {
                    name: "Cookie",
                    domain: "Service",
                    description: "Description",
                    expiration: "Expiration",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Used to distinguish users and sessions",
                      expiration: "2 years",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Used to distinguish users",
                      expiration: "24 hours",
                    },
                  ],
                },
              },
              {
                title: "More information",
                description:
                  'For any questions about our cookie policy, please visit our <a href="/privacy">Privacy Policy</a> or <a href="/support">contact us</a>.',
              },
            ],
          },
        },
        es: {
          consentModal: {
            title: "Valoramos tu privacidad",
            description:
              'Utilizamos cookies para mejorar tu experiencia de navegación y analizar el tráfico del sitio. Al hacer clic en "Aceptar todo", aceptas el uso de cookies.',
            acceptAllBtn: "Aceptar todo",
            acceptNecessaryBtn: "Rechazar todo",
            showPreferencesBtn: "Gestionar preferencias",
            footer: `
              <a href="/privacy">Política de Privacidad</a>
              <a href="/terms">Términos de Servicio</a>
            `,
          },
          preferencesModal: {
            title: "Preferencias de Cookies",
            acceptAllBtn: "Aceptar todo",
            acceptNecessaryBtn: "Rechazar todo",
            savePreferencesBtn: "Guardar preferencias",
            closeIconLabel: "Cerrar ventana",
            serviceCounterLabel: "Servicio|Servicios",
            sections: [
              {
                title: "Tus Opciones de Privacidad",
                description:
                  "En este panel puedes gestionar tus preferencias de cookies. Puedes revisar y cambiar tus opciones en cualquier momento reabriendo este panel a través del enlace de configuración de cookies en el pie de página.",
              },
              {
                title: "Estrictamente Necesarias",
                description:
                  "Estas cookies son esenciales para el funcionamiento del sitio web y no se pueden desactivar. Normalmente se establecen en respuesta a tus acciones como configurar preferencias de privacidad o iniciar sesión.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Analíticas",
                description:
                  "Estas cookies nos ayudan a entender cómo los visitantes interactúan con nuestro sitio web recopilando información de forma anónima.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Cookies analíticas",
                  headers: {
                    name: "Cookie",
                    domain: "Servicio",
                    description: "Descripción",
                    expiration: "Expiración",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Utilizada para distinguir usuarios y sesiones",
                      expiration: "2 años",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Utilizada para distinguir usuarios",
                      expiration: "24 horas",
                    },
                  ],
                },
              },
              {
                title: "Más información",
                description:
                  'Para cualquier pregunta sobre nuestra política de cookies, visita nuestra <a href="/privacy">Política de Privacidad</a> o <a href="/support">contáctanos</a>.',
              },
            ],
          },
        },
        fr: {
          consentModal: {
            title: "Nous respectons votre vie privée",
            description:
              'Nous utilisons des cookies pour améliorer votre expérience de navigation et analyser le trafic du site. En cliquant sur "Tout accepter", vous consentez à notre utilisation des cookies.',
            acceptAllBtn: "Tout accepter",
            acceptNecessaryBtn: "Tout refuser",
            showPreferencesBtn: "Gérer les préférences",
            footer: `
              <a href="/privacy">Politique de Confidentialité</a>
              <a href="/terms">Conditions d'Utilisation</a>
            `,
          },
          preferencesModal: {
            title: "Préférences de Cookies",
            acceptAllBtn: "Tout accepter",
            acceptNecessaryBtn: "Tout refuser",
            savePreferencesBtn: "Enregistrer les préférences",
            closeIconLabel: "Fermer la fenêtre",
            serviceCounterLabel: "Service|Services",
            sections: [
              {
                title: "Vos Choix de Confidentialité",
                description:
                  "Dans ce panneau, vous pouvez gérer vos préférences de cookies. Vous pouvez revoir et modifier vos choix à tout moment en rouvrant ce panneau via le lien des paramètres de cookies dans le pied de page.",
              },
              {
                title: "Strictement Nécessaires",
                description:
                  "Ces cookies sont essentiels au bon fonctionnement du site web et ne peuvent pas être désactivés. Ils sont généralement définis en réponse à vos actions comme la configuration des préférences de confidentialité ou la connexion.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Analytiques",
                description:
                  "Ces cookies nous aident à comprendre comment les visiteurs interagissent avec notre site web en collectant des informations de manière anonyme.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Cookies analytiques",
                  headers: {
                    name: "Cookie",
                    domain: "Service",
                    description: "Description",
                    expiration: "Expiration",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Utilisé pour distinguer les utilisateurs et les sessions",
                      expiration: "2 ans",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Utilisé pour distinguer les utilisateurs",
                      expiration: "24 heures",
                    },
                  ],
                },
              },
              {
                title: "Plus d'informations",
                description:
                  'Pour toute question concernant notre politique de cookies, veuillez consulter notre <a href="/privacy">Politique de Confidentialité</a> ou <a href="/support">nous contacter</a>.',
              },
            ],
          },
        },
        de: {
          consentModal: {
            title: "Wir schätzen Ihre Privatsphäre",
            description:
              'Wir verwenden Cookies, um Ihr Surferlebnis zu verbessern und den Website-Traffic zu analysieren. Durch Klicken auf "Alle akzeptieren" stimmen Sie der Verwendung von Cookies zu.',
            acceptAllBtn: "Alle akzeptieren",
            acceptNecessaryBtn: "Alle ablehnen",
            showPreferencesBtn: "Einstellungen verwalten",
            footer: `
              <a href="/privacy">Datenschutzrichtlinie</a>
              <a href="/terms">Nutzungsbedingungen</a>
            `,
          },
          preferencesModal: {
            title: "Cookie-Einstellungen",
            acceptAllBtn: "Alle akzeptieren",
            acceptNecessaryBtn: "Alle ablehnen",
            savePreferencesBtn: "Einstellungen speichern",
            closeIconLabel: "Fenster schließen",
            serviceCounterLabel: "Dienst|Dienste",
            sections: [
              {
                title: "Ihre Datenschutz-Optionen",
                description:
                  "In diesem Bereich können Sie Ihre Cookie-Einstellungen verwalten. Sie können Ihre Auswahl jederzeit überprüfen und ändern, indem Sie dieses Fenster über den Cookie-Einstellungen-Link in der Fußzeile erneut öffnen.",
              },
              {
                title: "Unbedingt Erforderlich",
                description:
                  "Diese Cookies sind für das ordnungsgemäße Funktionieren der Website unerlässlich und können nicht deaktiviert werden. Sie werden normalerweise als Reaktion auf Ihre Aktionen gesetzt, wie z.B. das Festlegen von Datenschutzeinstellungen oder das Anmelden.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Analyse",
                description:
                  "Diese Cookies helfen uns, zu verstehen, wie Besucher mit unserer Website interagieren, indem sie Informationen anonym sammeln.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Analyse-Cookies",
                  headers: {
                    name: "Cookie",
                    domain: "Dienst",
                    description: "Beschreibung",
                    expiration: "Ablauf",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Wird verwendet, um Benutzer und Sitzungen zu unterscheiden",
                      expiration: "2 Jahre",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Wird verwendet, um Benutzer zu unterscheiden",
                      expiration: "24 Stunden",
                    },
                  ],
                },
              },
              {
                title: "Weitere Informationen",
                description:
                  'Bei Fragen zu unserer Cookie-Richtlinie besuchen Sie bitte unsere <a href="/privacy">Datenschutzrichtlinie</a> oder <a href="/support">kontaktieren Sie uns</a>.',
              },
            ],
          },
        },
        it: {
          consentModal: {
            title: "Rispettiamo la tua privacy",
            description:
              'Utilizziamo i cookie per migliorare la tua esperienza di navigazione e analizzare il traffico del sito. Cliccando su "Accetta tutto", acconsenti all\'uso dei cookie.',
            acceptAllBtn: "Accetta tutto",
            acceptNecessaryBtn: "Rifiuta tutto",
            showPreferencesBtn: "Gestisci preferenze",
            footer: `
              <a href="/privacy">Informativa sulla Privacy</a>
              <a href="/terms">Termini di Servizio</a>
            `,
          },
          preferencesModal: {
            title: "Preferenze Cookie",
            acceptAllBtn: "Accetta tutto",
            acceptNecessaryBtn: "Rifiuta tutto",
            savePreferencesBtn: "Salva preferenze",
            closeIconLabel: "Chiudi finestra",
            serviceCounterLabel: "Servizio|Servizi",
            sections: [
              {
                title: "Le Tue Scelte sulla Privacy",
                description:
                  "In questo pannello puoi gestire le tue preferenze sui cookie. Puoi rivedere e modificare le tue scelte in qualsiasi momento riaprendo questo pannello tramite il link delle impostazioni cookie nel footer.",
              },
              {
                title: "Strettamente Necessari",
                description:
                  "Questi cookie sono essenziali per il corretto funzionamento del sito web e non possono essere disattivati. Vengono solitamente impostati in risposta alle tue azioni come l'impostazione delle preferenze sulla privacy o l'accesso.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Analitici",
                description:
                  "Questi cookie ci aiutano a capire come i visitatori interagiscono con il nostro sito web raccogliendo informazioni in modo anonimo.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Cookie analitici",
                  headers: {
                    name: "Cookie",
                    domain: "Servizio",
                    description: "Descrizione",
                    expiration: "Scadenza",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Utilizzato per distinguere utenti e sessioni",
                      expiration: "2 anni",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Utilizzato per distinguere gli utenti",
                      expiration: "24 ore",
                    },
                  ],
                },
              },
              {
                title: "Maggiori informazioni",
                description:
                  'Per qualsiasi domanda sulla nostra politica sui cookie, visita la nostra <a href="/privacy">Informativa sulla Privacy</a> o <a href="/support">contattaci</a>.',
              },
            ],
          },
        },
        pt: {
          consentModal: {
            title: "Valorizamos a sua privacidade",
            description:
              'Utilizamos cookies para melhorar a sua experiência de navegação e analisar o tráfego do site. Ao clicar em "Aceitar tudo", você consente com o uso de cookies.',
            acceptAllBtn: "Aceitar tudo",
            acceptNecessaryBtn: "Rejeitar tudo",
            showPreferencesBtn: "Gerir preferências",
            footer: `
              <a href="/privacy">Política de Privacidade</a>
              <a href="/terms">Termos de Serviço</a>
            `,
          },
          preferencesModal: {
            title: "Preferências de Cookies",
            acceptAllBtn: "Aceitar tudo",
            acceptNecessaryBtn: "Rejeitar tudo",
            savePreferencesBtn: "Guardar preferências",
            closeIconLabel: "Fechar janela",
            serviceCounterLabel: "Serviço|Serviços",
            sections: [
              {
                title: "As Suas Escolhas de Privacidade",
                description:
                  "Neste painel pode gerir as suas preferências de cookies. Pode rever e alterar as suas escolhas a qualquer momento reabrindo este painel através do link de configurações de cookies no rodapé.",
              },
              {
                title: "Estritamente Necessários",
                description:
                  "Estes cookies são essenciais para o funcionamento correto do site e não podem ser desativados. São normalmente definidos em resposta às suas ações como definir preferências de privacidade ou iniciar sessão.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Analíticos",
                description:
                  "Estes cookies ajudam-nos a entender como os visitantes interagem com o nosso site ao recolher informações de forma anónima.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Cookies analíticos",
                  headers: {
                    name: "Cookie",
                    domain: "Serviço",
                    description: "Descrição",
                    expiration: "Expiração",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Utilizado para distinguir utilizadores e sessões",
                      expiration: "2 anos",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Utilizado para distinguir utilizadores",
                      expiration: "24 horas",
                    },
                  ],
                },
              },
              {
                title: "Mais informações",
                description:
                  'Para qualquer questão sobre a nossa política de cookies, visite a nossa <a href="/privacy">Política de Privacidade</a> ou <a href="/support">contate-nos</a>.',
              },
            ],
          },
        },
        nl: {
          consentModal: {
            title: "Wij respecteren uw privacy",
            description:
              'Wij gebruiken cookies om uw surfervaring te verbeteren en het websiteverkeer te analyseren. Door op "Alles accepteren" te klikken, stemt u in met ons gebruik van cookies.',
            acceptAllBtn: "Alles accepteren",
            acceptNecessaryBtn: "Alles weigeren",
            showPreferencesBtn: "Voorkeuren beheren",
            footer: `
              <a href="/privacy">Privacybeleid</a>
              <a href="/terms">Gebruiksvoorwaarden</a>
            `,
          },
          preferencesModal: {
            title: "Cookie-voorkeuren",
            acceptAllBtn: "Alles accepteren",
            acceptNecessaryBtn: "Alles weigeren",
            savePreferencesBtn: "Voorkeuren opslaan",
            closeIconLabel: "Venster sluiten",
            serviceCounterLabel: "Dienst|Diensten",
            sections: [
              {
                title: "Uw Privacykeuzes",
                description:
                  "In dit paneel kunt u uw cookievoorkeuren beheren. U kunt uw keuzes op elk moment herzien en wijzigen door dit paneel opnieuw te openen via de cookie-instellingen link in de footer.",
              },
              {
                title: "Strikt Noodzakelijk",
                description:
                  "Deze cookies zijn essentieel voor het goed functioneren van de website en kunnen niet worden uitgeschakeld. Ze worden meestal ingesteld als reactie op uw acties zoals het instellen van privacyvoorkeuren of inloggen.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Analytisch",
                description:
                  "Deze cookies helpen ons te begrijpen hoe bezoekers met onze website omgaan door anoniem informatie te verzamelen.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Analytische cookies",
                  headers: {
                    name: "Cookie",
                    domain: "Dienst",
                    description: "Beschrijving",
                    expiration: "Vervaldatum",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Gebruikt om gebruikers en sessies te onderscheiden",
                      expiration: "2 jaar",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Gebruikt om gebruikers te onderscheiden",
                      expiration: "24 uur",
                    },
                  ],
                },
              },
              {
                title: "Meer informatie",
                description:
                  'Voor vragen over ons cookiebeleid, bezoek ons <a href="/privacy">Privacybeleid</a> of <a href="/support">neem contact met ons op</a>.',
              },
            ],
          },
        },
        ja: {
          consentModal: {
            title: "プライバシーを尊重します",
            description:
              "当サイトでは、ブラウジング体験の向上とサイトトラフィックの分析のためにCookieを使用しています。「すべて承認」をクリックすると、Cookieの使用に同意したことになります。",
            acceptAllBtn: "すべて承認",
            acceptNecessaryBtn: "すべて拒否",
            showPreferencesBtn: "設定を管理",
            footer: `
              <a href="/privacy">プライバシーポリシー</a>
              <a href="/terms">利用規約</a>
            `,
          },
          preferencesModal: {
            title: "Cookie設定",
            acceptAllBtn: "すべて承認",
            acceptNecessaryBtn: "すべて拒否",
            savePreferencesBtn: "設定を保存",
            closeIconLabel: "閉じる",
            serviceCounterLabel: "サービス",
            sections: [
              {
                title: "プライバシーの選択",
                description:
                  "このパネルでCookieの設定を管理できます。フッターのCookie設定リンクからこのパネルを再度開くことで、いつでも選択を確認・変更できます。",
              },
              {
                title: "必須Cookie",
                description:
                  "これらのCookieはウェブサイトが正常に機能するために不可欠であり、無効にすることはできません。通常、プライバシー設定の構成やログインなど、お客様の操作に応じて設定されます。",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "分析Cookie",
                description:
                  "これらのCookieは、匿名で情報を収集し、訪問者が当サイトとどのようにやり取りしているかを理解するのに役立ちます。",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "分析Cookie",
                  headers: {
                    name: "Cookie",
                    domain: "サービス",
                    description: "説明",
                    expiration: "有効期限",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "ユーザーとセッションを区別するために使用",
                      expiration: "2年",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "ユーザーを区別するために使用",
                      expiration: "24時間",
                    },
                  ],
                },
              },
              {
                title: "詳細情報",
                description:
                  'Cookieポリシーに関するご質問は、<a href="/privacy">プライバシーポリシー</a>をご覧いただくか、<a href="/support">お問い合わせ</a>ください。',
              },
            ],
          },
        },
        zh: {
          consentModal: {
            title: "我们重视您的隐私",
            description:
              '我们使用Cookie来增强您的浏览体验并分析网站流量。点击"全部接受"即表示您同意我们使用Cookie。',
            acceptAllBtn: "全部接受",
            acceptNecessaryBtn: "全部拒绝",
            showPreferencesBtn: "管理偏好设置",
            footer: `
              <a href="/privacy">隐私政策</a>
              <a href="/terms">服务条款</a>
            `,
          },
          preferencesModal: {
            title: "Cookie偏好设置",
            acceptAllBtn: "全部接受",
            acceptNecessaryBtn: "全部拒绝",
            savePreferencesBtn: "保存设置",
            closeIconLabel: "关闭窗口",
            serviceCounterLabel: "服务",
            sections: [
              {
                title: "您的隐私选择",
                description:
                  "在此面板中，您可以管理Cookie偏好设置。您可以随时通过页脚的Cookie设置链接重新打开此面板来查看和更改您的选择。",
              },
              {
                title: "必要Cookie",
                description:
                  "这些Cookie对网站的正常运行至关重要，无法禁用。它们通常是响应您的操作而设置的，例如设置隐私首选项或登录。",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "分析Cookie",
                description: "这些Cookie通过匿名收集信息，帮助我们了解访问者如何与我们的网站互动。",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "分析Cookie",
                  headers: {
                    name: "Cookie",
                    domain: "服务",
                    description: "说明",
                    expiration: "有效期",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "用于区分用户和会话",
                      expiration: "2年",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "用于区分用户",
                      expiration: "24小时",
                    },
                  ],
                },
              },
              {
                title: "更多信息",
                description:
                  '如有关于Cookie政策的问题，请访问我们的<a href="/privacy">隐私政策</a>或<a href="/support">联系我们</a>。',
              },
            ],
          },
        },
        ko: {
          consentModal: {
            title: "개인정보를 소중히 여깁니다",
            description:
              '저희는 브라우징 경험을 향상시키고 사이트 트래픽을 분석하기 위해 쿠키를 사용합니다. "모두 수락"을 클릭하면 쿠키 사용에 동의하게 됩니다.',
            acceptAllBtn: "모두 수락",
            acceptNecessaryBtn: "모두 거부",
            showPreferencesBtn: "환경설정 관리",
            footer: `
              <a href="/privacy">개인정보 처리방침</a>
              <a href="/terms">이용약관</a>
            `,
          },
          preferencesModal: {
            title: "쿠키 환경설정",
            acceptAllBtn: "모두 수락",
            acceptNecessaryBtn: "모두 거부",
            savePreferencesBtn: "설정 저장",
            closeIconLabel: "창 닫기",
            serviceCounterLabel: "서비스",
            sections: [
              {
                title: "개인정보 보호 선택",
                description:
                  "이 패널에서 쿠키 환경설정을 관리할 수 있습니다. 푸터의 쿠키 설정 링크를 통해 이 패널을 다시 열어 언제든지 선택을 검토하고 변경할 수 있습니다.",
              },
              {
                title: "필수 쿠키",
                description:
                  "이 쿠키는 웹사이트가 제대로 작동하는 데 필수적이며 비활성화할 수 없습니다. 일반적으로 개인정보 설정 구성이나 로그인과 같은 사용자 작업에 대한 응답으로 설정됩니다.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "분석 쿠키",
                description:
                  "이 쿠키는 익명으로 정보를 수집하여 방문자가 웹사이트와 어떻게 상호작용하는지 이해하는 데 도움이 됩니다.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "분석 쿠키",
                  headers: {
                    name: "쿠키",
                    domain: "서비스",
                    description: "설명",
                    expiration: "만료",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "사용자와 세션을 구분하는 데 사용",
                      expiration: "2년",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "사용자를 구분하는 데 사용",
                      expiration: "24시간",
                    },
                  ],
                },
              },
              {
                title: "추가 정보",
                description:
                  '쿠키 정책에 대한 질문이 있으시면 <a href="/privacy">개인정보 처리방침</a>을 방문하시거나 <a href="/support">문의</a>해 주세요.',
              },
            ],
          },
        },
        ar: {
          consentModal: {
            title: "نحن نقدر خصوصيتك",
            description:
              'نستخدم ملفات تعريف الارتباط لتحسين تجربة التصفح وتحليل حركة المرور على الموقع. بالنقر على "قبول الكل"، فإنك توافق على استخدامنا لملفات تعريف الارتباط.',
            acceptAllBtn: "قبول الكل",
            acceptNecessaryBtn: "رفض الكل",
            showPreferencesBtn: "إدارة التفضيلات",
            footer: `
              <a href="/privacy">سياسة الخصوصية</a>
              <a href="/terms">شروط الخدمة</a>
            `,
          },
          preferencesModal: {
            title: "تفضيلات ملفات تعريف الارتباط",
            acceptAllBtn: "قبول الكل",
            acceptNecessaryBtn: "رفض الكل",
            savePreferencesBtn: "حفظ التفضيلات",
            closeIconLabel: "إغلاق النافذة",
            serviceCounterLabel: "خدمة|خدمات",
            sections: [
              {
                title: "خيارات الخصوصية الخاصة بك",
                description:
                  "في هذه اللوحة يمكنك إدارة تفضيلات ملفات تعريف الارتباط. يمكنك مراجعة وتغيير اختياراتك في أي وقت عن طريق إعادة فتح هذه اللوحة عبر رابط إعدادات ملفات تعريف الارتباط في التذييل.",
              },
              {
                title: "ضرورية للغاية",
                description:
                  "ملفات تعريف الارتباط هذه ضرورية لعمل الموقع بشكل صحيح ولا يمكن تعطيلها. عادة ما يتم تعيينها استجابة لإجراءاتك مثل تعيين تفضيلات الخصوصية أو تسجيل الدخول.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "التحليلات",
                description:
                  "تساعدنا ملفات تعريف الارتباط هذه على فهم كيفية تفاعل الزوار مع موقعنا من خلال جمع المعلومات بشكل مجهول.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "ملفات تعريف الارتباط التحليلية",
                  headers: {
                    name: "ملف تعريف الارتباط",
                    domain: "الخدمة",
                    description: "الوصف",
                    expiration: "انتهاء الصلاحية",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "يستخدم للتمييز بين المستخدمين والجلسات",
                      expiration: "سنتان",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "يستخدم للتمييز بين المستخدمين",
                      expiration: "24 ساعة",
                    },
                  ],
                },
              },
              {
                title: "مزيد من المعلومات",
                description:
                  'لأي أسئلة حول سياسة ملفات تعريف الارتباط الخاصة بنا، يرجى زيارة <a href="/privacy">سياسة الخصوصية</a> أو <a href="/support">اتصل بنا</a>.',
              },
            ],
          },
        },
        pl: {
          consentModal: {
            title: "Cenimy Twoją prywatność",
            description:
              'Używamy plików cookie, aby poprawić Twoje wrażenia z przeglądania i analizować ruch na stronie. Klikając "Zaakceptuj wszystkie", wyrażasz zgodę na używanie przez nas plików cookie.',
            acceptAllBtn: "Zaakceptuj wszystkie",
            acceptNecessaryBtn: "Odrzuć wszystkie",
            showPreferencesBtn: "Zarządzaj preferencjami",
            footer: `
              <a href="/privacy">Polityka Prywatności</a>
              <a href="/terms">Warunki Usługi</a>
            `,
          },
          preferencesModal: {
            title: "Preferencje Plików Cookie",
            acceptAllBtn: "Zaakceptuj wszystkie",
            acceptNecessaryBtn: "Odrzuć wszystkie",
            savePreferencesBtn: "Zapisz preferencje",
            closeIconLabel: "Zamknij okno",
            serviceCounterLabel: "Usługa|Usługi",
            sections: [
              {
                title: "Twoje Wybory Dotyczące Prywatności",
                description:
                  "W tym panelu możesz zarządzać swoimi preferencjami dotyczącymi plików cookie. Możesz przeglądać i zmieniać swoje wybory w dowolnym momencie, ponownie otwierając ten panel za pomocą linku ustawień plików cookie w stopce.",
              },
              {
                title: "Ściśle Niezbędne",
                description:
                  "Te pliki cookie są niezbędne do prawidłowego funkcjonowania strony internetowej i nie można ich wyłączyć. Są zwykle ustawiane w odpowiedzi na Twoje działania, takie jak ustawianie preferencji prywatności lub logowanie.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Analityczne",
                description:
                  "Te pliki cookie pomagają nam zrozumieć, w jaki sposób odwiedzający wchodzą w interakcję z naszą stroną, zbierając informacje anonimowo.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Analityczne pliki cookie",
                  headers: {
                    name: "Cookie",
                    domain: "Usługa",
                    description: "Opis",
                    expiration: "Wygaśnięcie",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Używany do rozróżniania użytkowników i sesji",
                      expiration: "2 lata",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Używany do rozróżniania użytkowników",
                      expiration: "24 godziny",
                    },
                  ],
                },
              },
              {
                title: "Więcej informacji",
                description:
                  'W razie pytań dotyczących naszej polityki plików cookie, odwiedź naszą <a href="/privacy">Politykę Prywatności</a> lub <a href="/support">skontaktuj się z nami</a>.',
              },
            ],
          },
        },
        tr: {
          consentModal: {
            title: "Gizliliğinize değer veriyoruz",
            description:
              'Tarama deneyiminizi geliştirmek ve site trafiğini analiz etmek için çerezler kullanıyoruz. "Tümünü kabul et"e tıklayarak çerez kullanımımızı kabul etmiş olursunuz.',
            acceptAllBtn: "Tümünü kabul et",
            acceptNecessaryBtn: "Tümünü reddet",
            showPreferencesBtn: "Tercihleri yönet",
            footer: `
              <a href="/privacy">Gizlilik Politikası</a>
              <a href="/terms">Hizmet Şartları</a>
            `,
          },
          preferencesModal: {
            title: "Çerez Tercihleri",
            acceptAllBtn: "Tümünü kabul et",
            acceptNecessaryBtn: "Tümünü reddet",
            savePreferencesBtn: "Tercihleri kaydet",
            closeIconLabel: "Pencereyi kapat",
            serviceCounterLabel: "Hizmet|Hizmetler",
            sections: [
              {
                title: "Gizlilik Tercihleriniz",
                description:
                  "Bu panelde çerez tercihlerinizi yönetebilirsiniz. Alt bilgideki çerez ayarları bağlantısı aracılığıyla bu paneli yeniden açarak tercihlerinizi istediğiniz zaman gözden geçirebilir ve değiştirebilirsiniz.",
              },
              {
                title: "Kesinlikle Gerekli",
                description:
                  "Bu çerezler web sitesinin düzgün çalışması için gereklidir ve devre dışı bırakılamaz. Genellikle gizlilik tercihlerini ayarlama veya oturum açma gibi eylemlerinize yanıt olarak ayarlanırlar.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Analitik",
                description:
                  "Bu çerezler, anonim olarak bilgi toplayarak ziyaretçilerin web sitemizle nasıl etkileşimde bulunduğunu anlamamıza yardımcı olur.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Analitik çerezler",
                  headers: {
                    name: "Çerez",
                    domain: "Hizmet",
                    description: "Açıklama",
                    expiration: "Süre",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Kullanıcıları ve oturumları ayırt etmek için kullanılır",
                      expiration: "2 yıl",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Kullanıcıları ayırt etmek için kullanılır",
                      expiration: "24 saat",
                    },
                  ],
                },
              },
              {
                title: "Daha fazla bilgi",
                description:
                  'Çerez politikamızla ilgili sorularınız için <a href="/privacy">Gizlilik Politikamızı</a> ziyaret edin veya <a href="/support">bizimle iletişime geçin</a>.',
              },
            ],
          },
        },
        sv: {
          consentModal: {
            title: "Vi värnar om din integritet",
            description:
              'Vi använder cookies för att förbättra din surfupplevelse och analysera webbplatstrafik. Genom att klicka på "Acceptera alla" samtycker du till vår användning av cookies.',
            acceptAllBtn: "Acceptera alla",
            acceptNecessaryBtn: "Avvisa alla",
            showPreferencesBtn: "Hantera inställningar",
            footer: `
              <a href="/privacy">Integritetspolicy</a>
              <a href="/terms">Användarvillkor</a>
            `,
          },
          preferencesModal: {
            title: "Cookie-inställningar",
            acceptAllBtn: "Acceptera alla",
            acceptNecessaryBtn: "Avvisa alla",
            savePreferencesBtn: "Spara inställningar",
            closeIconLabel: "Stäng fönster",
            serviceCounterLabel: "Tjänst|Tjänster",
            sections: [
              {
                title: "Dina Integritetsval",
                description:
                  "I den här panelen kan du hantera dina cookie-inställningar. Du kan granska och ändra dina val när som helst genom att öppna denna panel via länken för cookie-inställningar i sidfoten.",
              },
              {
                title: "Strikt Nödvändiga",
                description:
                  "Dessa cookies är nödvändiga för att webbplatsen ska fungera korrekt och kan inte inaktiveras. De ställs vanligtvis in som svar på dina åtgärder som att ställa in integritetsinställningar eller logga in.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Analys",
                description:
                  "Dessa cookies hjälper oss att förstå hur besökare interagerar med vår webbplats genom att samla in information anonymt.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Analyticscookies",
                  headers: {
                    name: "Cookie",
                    domain: "Tjänst",
                    description: "Beskrivning",
                    expiration: "Utgång",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Används för att skilja användare och sessioner åt",
                      expiration: "2 år",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Används för att skilja användare åt",
                      expiration: "24 timmar",
                    },
                  ],
                },
              },
              {
                title: "Mer information",
                description:
                  'För frågor om vår cookie-policy, besök vår <a href="/privacy">Integritetspolicy</a> eller <a href="/support">kontakta oss</a>.',
              },
            ],
          },
        },
        ru: {
          consentModal: {
            title: "Мы ценим вашу конфиденциальность",
            description:
              'Мы используем файлы cookie для улучшения вашего опыта просмотра и анализа трафика сайта. Нажимая "Принять все", вы соглашаетесь на использование файлов cookie.',
            acceptAllBtn: "Принять все",
            acceptNecessaryBtn: "Отклонить все",
            showPreferencesBtn: "Управление настройками",
            footer: `
              <a href="/privacy">Политика конфиденциальности</a>
              <a href="/terms">Условия использования</a>
            `,
          },
          preferencesModal: {
            title: "Настройки файлов cookie",
            acceptAllBtn: "Принять все",
            acceptNecessaryBtn: "Отклонить все",
            savePreferencesBtn: "Сохранить настройки",
            closeIconLabel: "Закрыть окно",
            serviceCounterLabel: "Сервис|Сервисы",
            sections: [
              {
                title: "Ваши настройки конфиденциальности",
                description:
                  "В этом панели вы можете управлять настройками файлов cookie. Вы можете просматривать и изменять свой выбор в любое время, повторно открыв эту панель через ссылку настроек cookie в нижнем колонтитуле.",
              },
              {
                title: "Строго необходимые",
                description:
                  "Эти файлы cookie необходимы для правильного функционирования веб-сайта и не могут быть отключены. Обычно они устанавливаются в ответ на ваши действия, такие как настройка параметров конфиденциальности или вход в систему.",
                linkedCategory: CAT_NECESSARY,
              },
              {
                title: "Аналитические",
                description:
                  "Эти файлы cookie помогают нам понять, как посетители взаимодействуют с нашим сайтом, собирая информацию анонимно.",
                linkedCategory: CAT_ANALYTICS,
                cookieTable: {
                  caption: "Аналитические файлы cookie",
                  headers: {
                    name: "Cookie",
                    domain: "Сервис",
                    description: "Описание",
                    expiration: "Срок действия",
                  },
                  body: [
                    {
                      name: "_ga",
                      domain: "Google Analytics",
                      description: "Используется для различения пользователей и сессий",
                      expiration: "2 года",
                    },
                    {
                      name: "_gid",
                      domain: "Google Analytics",
                      description: "Используется для различения пользователей",
                      expiration: "24 часа",
                    },
                  ],
                },
              },
              {
                title: "Дополнительная информация",
                description:
                  'По любым вопросам о нашей политике cookie, пожалуйста, посетите нашу <a href="/privacy">Политику конфиденциальности</a> или <a href="/support">свяжитесь с нами</a>.',
              },
            ],
          },
        },
      },
    },
  });

  // Expose show preferences function globally for footer link
  (window as Window & { showCookiePreferences?: () => void }).showCookiePreferences = () => {
    CookieConsent.showPreferences();
  };

  /**
   * Syncs cookie consent dark mode with the site's theme.
   */
  function syncDarkMode() {
    const isDark = document.documentElement.classList.contains("dark");
    const ccMain = document.getElementById("cc-main");
    if (ccMain) {
      ccMain.classList.toggle("cc--darkmode", isDark);
    }
  }

  // Initial sync after DOM is ready
  syncDarkMode();

  // Watch for theme changes via MutationObserver on <html> class
  const observer = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if (mutation.attributeName === "class") {
        syncDarkMode();
      }
    });
  });

  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ["class"],
  });
</script>
